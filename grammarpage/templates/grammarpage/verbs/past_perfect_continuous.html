{% extends 'grammarpage/grammar_base.html' %}
{% load static %}
{% load i18n %}

{% block grammar_title %}{% translate "The Past Perfect Continuous" %}{% endblock %}

{% block extra_css %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'style/grammar_list.css' %}">
    <style>
        .main-container {
            padding-top: 40px;
        }

        .grammar-detail-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #e0e0e0;
        }

        h3, h4 {
            color: #ff9e7d;
            border-bottom: 2px solid #444;
            padding-bottom: 5px;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        h3 {
            font-size: 24px;
        }

        h4 {
            font-size: 20px;
            margin-top: 25px;
        }

        h5 {
            font-size: 18px;
            color: #83e8de;
            margin-top: 15px;
            margin-bottom: 10px;
        }

        p {
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .grammar-divider {
            border: 1px solid #444;
            margin: 20px 0;
        }

        .styled-list {
            list-style-type: none;
            padding-left: 20px;
        }

        .styled-list li {
            margin: 8px 0;
            position: relative;
            padding-left: 25px;
        }

        .styled-list li:before {
            content: "•";
            color: #4cc9f0;
            font-weight: bold;
            position: absolute;
            left: 0;
            top: 0;
        }
        
        .styled-list ol {
            padding-left: 20px;
        }

        .styled-list ol li {
            padding-left: 0;
            list-style-type: decimal;
            margin-left: 20px;
        }

        .styled-list ol li:before {
            display: none;
        }

        .styled-list .styled-list li:before {
            content: "-";
        }
        
        .styled-list .styled-list .styled-list li:before {
            content: "•";
        }

        .styled-list li ul.styled-list {
            margin-top: 5px;
        }

        .styled-list li ul.styled-list li {
            padding-left: 15px;
            margin: 4px 0;
        }

        .term-highlight, .pronoun-highlight {
            color: #ff9e7d;
            font-weight: 600;
        }
        
        .auxiliary-highlight, .ending-highlight {
            color: #83e8de;
            font-weight: 600;
        }

        .verb-highlight {
            color: #ffda47;
            font-weight: 600;
        }

        .time-highlight {
            color: #b388ff;
            font-weight: 500;
        }
        
        .code-highlight {
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.2);
            display: inline-block;
            margin: 5px 0;
            padding: 2px 4px;
            border-radius: 4px;
            color: #83e8de;
            white-space: nowrap;
        }

        .example-highlight {
            color: #4cc9f0;
            font-weight: 500;
        }

        .grammar-table-container {
            overflow-x: auto;
            margin: 20px 0;
        }

        .grammar-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(0, 0, 0, 0.1);
        }

        .grammar-table th, .grammar-table td {
            border: 1px solid #444;
            padding: 10px;
            text-align: left;
        }

        .grammar-table th {
            background: rgba(0, 0, 0, 0.2);
            font-weight: bold;
        }

        .back-to-list-btn {
            display: inline-block;
            margin-top: 30px;
            padding: 10px 20px;
            background-color: #4cc9f0;
            color: #1e1e1e;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .back-to-list-btn:hover {
            background-color: #ff9e7d;
        }
        
        @media (max-width: 600px) {
            .grammar-detail-container {
                padding: 10px;
            }
        }
    </style>
{% endblock %}

{% block grammar_content %}
    <div class="grammar-detail-container">
        <nav class="breadcrumbs">
            <a href="{% url 'home' %}">{% translate "Home" %}</a> &raquo;
            <span><a href="{% url 'grammar_page' %}">{% translate "Grammar" %}</a></span> &raquo;
            <span><a href="{% url 'verbs_page' %}">{% translate "Verbs" %}</a></span> &raquo;
            <span>{% translate "The Past Perfect Continuous" %}</span>
        </nav>

        <h1>{% translate "The Past Perfect Continuous (Past Perfect Progressive)" %}</h1>
        <p>
            {% translate "The <span class=\"term-highlight\">Past Perfect Continuous</span> tense (also known as the Past Perfect Progressive) is used to describe an action that started in the past and continued up to another specific point or event in the past. It emphasizes the <i>duration</i> of the activity before that later past point." %}
        </p>

        <hr class="grammar-divider">

        <h4>{% translate "Formation of the Past Perfect Continuous" %}</h4>
        <p>
            {% translate "The Past Perfect Continuous is formed using the auxiliary verb <span class=\"auxiliary-highlight\">\"had\"</span> + <span class=\"auxiliary-highlight\">\"been\"</span> + the <span class=\"term-highlight\">present participle (-ing form)</span> of the main verb. <span class=\"code-highlight\">Had been</span> is used for all subjects." %}
        </p>

        <h5>{% translate "1. Affirmative Sentences" %}</h5>
        <div class="grammar-table-container">
            <table class="grammar-table">
                <thead>
                    <tr>
                        <th>{% translate "Person / Number" %}</th>
                        <th>{% translate "Auxiliary 1" %} (<span class="code-highlight">had</span>)</th>
                        <th>{% translate "Auxiliary 2" %} (<span class="code-highlight">been</span>)</th>
                        <th>{% translate "Main Verb" %} (<span class="code-highlight">to work</span>) (V-ing)</th>
                        <th>{% translate "Example" %}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td><span class="pronoun-highlight">I</span></td><td><span class="auxiliary-highlight">had</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "I had been working." %}</span></td></tr>
                    <tr><td><span class="pronoun-highlight">You</span></td><td><span class="auxiliary-highlight">had</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "You had been working." %}</span></td></tr>
                    <tr><td><span class="pronoun-highlight">He / She / It</span></td><td><span class="auxiliary-highlight">had</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "He had been working." %}</span></td></tr>
                    <tr><td><span class="pronoun-highlight">We</span></td><td><span class="auxiliary-highlight">had</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "We had been working." %}</span></td></tr>
                    <tr><td><span class="pronoun-highlight">You</span></td><td><span class="auxiliary-highlight">had</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "You had been working." %}</span></td></tr>
                    <tr><td><span class="pronoun-highlight">They</span></td><td><span class="auxiliary-highlight">had</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "They had been working." %}</span></td></tr>
                </tbody>
            </table>
        </div>
        <ul class="styled-list">
            <li><span class="term-highlight">{% translate "Contractions:" %}</span> {% translate "In informal speech and writing, contractions are very common:" %}
                <ul class="styled-list">
                    <li><span class="code-highlight">{% translate "I'd been working" %}</span></li>
                    <li><span class="code-highlight">{% translate "You'd been working" %}</span></li>
                    <li><span class="code-highlight">{% translate "He'd / She'd / It'd been working" %}</span></li>
                    <li><span class="code-highlight">{% translate "We'd been working" %}</span></li>
                    <li><span class="code-highlight">{% translate "They'd been working" %}</span></li>
                </ul>
            </li>
        </ul>

        <hr class="grammar-divider">

        <h5>{% translate "2. Negative Sentences" %}</h5>
        <p>
            {% translate "To form negative sentences, we place <span class=\"term-highlight\">'not'</span> after the first auxiliary verb \"had\"." %}
        </p>
        <div class="grammar-table-container">
            <table class="grammar-table">
                <thead>
                    <tr>
                        <th>{% translate "Person / Number" %}</th>
                        <th>{% translate "Auxiliary 1" %} (<span class="code-highlight">had</span>) + not</th>
                        <th>{% translate "Auxiliary 2" %} (<span class="code-highlight">been</span>)</th>
                        <th>{% translate "Main Verb" %} (<span class="code-highlight">to work</span>) (V-ing)</th>
                        <th>{% translate "Example" %}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td><span class="pronoun-highlight">I</span></td><td><span class="auxiliary-highlight">had</span> not / hadn't</td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "I had not been working." %}</span> / <span class="code-highlight">{% translate "I hadn't been working." %}</span></td></tr>
                    <tr><td><span class="pronoun-highlight">You</span></td><td><span class="auxiliary-highlight">had</span> not / hadn't</td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "You had not been working." %}</span> / <span class="code-highlight">{% translate "You hadn't been working." %}</span></td></tr>
                    <tr><td><span class="pronoun-highlight">He / She / It</span></td><td><span class="auxiliary-highlight">had</span> not / hadn't</td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "He had not been working." %}</span> / <span class="code-highlight">{% translate "He hadn't been working." %}</span></td></tr>
                    <tr><td><span class="pronoun-highlight">We</span></td><td><span class="auxiliary-highlight">had</span> not / hadn't</td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "We had not been working." %}</span> / <span class="code-highlight">{% translate "We hadn't been working." %}</span></td></tr>
                    <tr><td><span class="pronoun-highlight">You</span></td><td><span class="auxiliary-highlight">had</span> not / hadn't</td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "You had not been working." %}</span> / <span class="code-highlight">{% translate "You hadn't been working." %}</span></td></tr>
                    <tr><td><span class="pronoun-highlight">They</span></td><td><span class="auxiliary-highlight">had</span> not / hadn't</td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span></td><td><span class="code-highlight">{% translate "They had not been working." %}</span> / <span class="code-highlight">{% translate "They hadn't been working." %}</span></td></tr>
                </tbody>
            </table>
        </div>
        <ul class="styled-list">
            <li><span class="example-highlight">{% translate "Example:" %}</span> <i><span class="code-highlight">{% translate "She hadn't been feeling well before she went to the doctor." %}</span></i></li>
            <li><span class="example-highlight">{% translate "Example:" %}</span> <i><span class="code-highlight">{% translate "They had not been studying for long when the power went out." %}</span></i></li>
        </ul>

        <hr class="grammar-divider">

        <h5>{% translate "3. Interrogative Sentences (Questions)" %}</h5>
        <p>
            {% translate "To form questions, we invert the subject and the first auxiliary verb \"had\"." %}
        </p>
        <div class="grammar-table-container">
            <table class="grammar-table">
                <thead>
                    <tr>
                        <th>{% translate "Auxiliary 1" %} (<span class="code-highlight">had</span>)</th>
                        <th>{% translate "Subject" %}</th>
                        <th>{% translate "Auxiliary 2" %} (<span class="code-highlight">been</span>)</th>
                        <th>{% translate "Main Verb" %} (<span class="code-highlight">to work</span>) (V-ing)</th>
                        <th>{% translate "Example" %}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td><span class="auxiliary-highlight">Had</span></td><td><span class="pronoun-highlight">I</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span>?</td><td><span class="code-highlight">{% translate "Had I been working?" %}</span></td></tr>
                    <tr><td><span class="auxiliary-highlight">Had</span></td><td><span class="pronoun-highlight">you</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span>?</td><td><span class="code-highlight">{% translate "Had you been working?" %}</span></td></tr>
                    <tr><td><span class="auxiliary-highlight">Had</span></td><td><span class="pronoun-highlight">he / she / it</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span>?</td><td><span class="code-highlight">{% translate "Had he been working?" %}</span></td></tr>
                    <tr><td><span class="auxiliary-highlight">Had</span></td><td><span class="pronoun-highlight">we</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span>?</td><td><span class="code-highlight">{% translate "Had we been working?" %}</span></td></tr>
                    <tr><td><span class="auxiliary-highlight">Had</span></td><td><span class="pronoun-highlight">you</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span>?</td><td><span class="code-highlight">{% translate "Had you been working?" %}</span></td></tr>
                    <tr><td><span class="auxiliary-highlight">Had</span></td><td><span class="pronoun-highlight">they</span></td><td><span class="auxiliary-highlight">been</span></td><td>work<span class="ending-highlight">ing</span>?</td><td><span class="code-highlight">{% translate "Had they been working?" %}</span></td></tr>
                </tbody>
            </table>
        </div>
        <ul class="styled-list">
            <li><span class="example-highlight">{% translate "Example:" %}</span> <i><span class="code-highlight">{% translate "Had you been waiting long when she finally arrived?" %}</span></i></li>
            <li><span class="example-highlight">{% translate "Example:" %}</span> <i><span class="code-highlight">{% translate "What had they been doing before the police came?" %}</span></i> ({% translate "for Wh-questions" %})</li>
        </ul>

        <hr class="grammar-divider">

        <h4>{% translate "Uses of the Past Perfect Continuous" %}</h4>
        <p>
            {% translate "The Past Perfect Continuous is used to express:" %}
        </p>
        <ol class="styled-list">
            <li><span class="term-highlight">{% translate "Actions that Started in the Past and Continued Up to Another Point in the Past:" %}</span> {% translate "This is the primary use. It emphasizes the duration of an activity that was ongoing before a specific time or another completed action in the past." %}
                <ul class="styled-list">
                    <li><i><span class="code-highlight">{% translate "He" %} <span class="verb-highlight">had been waiting</span> {% translate "for two hours when she finally arrived." %}</span></i> ({% translate "He waited for two hours, and then she arrived." %})</li>
                    <li><i><span class="code-highlight">{% translate "I was tired because I" %} <span class="verb-highlight">had been running</span> {% translate "for an hour." %}</span></i> ({% translate "First, I ran for an hour; then, I was tired." %})</li>
                    <li><i><span class="code-highlight">{% translate "They" %} <span class="verb-highlight">had been living</span> {% translate "in that house for ten years before they sold it." %}</span></i> ({% translate "They lived there for ten years, then they sold it." %})</li>
                </ul>
            </li>
            <li><span class="term-highlight">{% translate "To Show Cause and Effect in the Past:" %}</span> {% translate "The Past Perfect Continuous describes the cause (an ongoing action) of a past result." %}
                <ul class="styled-list">
                    <li><i><span class="code-highlight">{% translate "The ground was wet because it" %} <span class="verb-highlight">had been raining</span> {% translate "all night." %}</span></i> ({% translate "The rain caused the wet ground." %})</li>
                    <li><i><span class="code-highlight">{% translate "She failed the exam because she" %} <span class="verb-highlight">hadn't been studying</span> {% translate "enough." %}</span></i> ({% translate "Lack of studying caused the failure." %})</li>
                </ul>
            </li>
            <li><span class="term-highlight">{% translate "In Reported Speech:" %}</span> {% translate "When reporting something that was originally said in the Present Perfect Continuous or Past Continuous, the tense shifts to the Past Perfect Continuous." %}
                <ul class="styled-list">
                    <li>{% translate "Direct speech:" %} <i><span class="code-highlight">{% translate "He said, \"I" %} <span class="verb-highlight">have been working</span> {% translate "all day.\"" %}</span></i></li>
                    <li>{% translate "Reported speech:" %} <i><span class="code-highlight">{% translate "He said that he" %} <span class="verb-highlight">had been working</span> {% translate "all day." %}</span></i></li>
                    <li>{% translate "Direct speech:" %} <i><span class="code-highlight">{% translate "She said, \"I" %} <span class="verb-highlight">was studying</span> {% translate "when you called.\"" %}</span></i></li>
                    <li>{% translate "Reported speech:" %} <i><span class="code-highlight">{% translate "She said that she" %} <span class="verb-highlight">had been studying</span> {% translate "when I called." %}</span></i></li>
                </ul>
            </li>
        </ol>

        <hr class="grammar-divider">

        <h4>{% translate "Past Perfect Continuous vs. Past Perfect Simple" %}</h4>
        <p>
            {% translate "The main difference lies in the emphasis:" %}
        </p>
        <ul class="styled-list">
            <li><span class="term-highlight">{% translate "Past Perfect Continuous:" %}</span> {% translate "Emphasizes the <i>duration</i> or the <i>process</i> of an action up to a certain point in the past." %}
                <ul class="styled-list">
                    <li><i><span class="code-highlight">{% translate "I" %} <span class="verb-highlight">had been writing</span> {% translate "the report for three hours before I took a break." %}</span></i> ({% translate "Focus on the <i>process</i> of writing." %})</li>
                </ul>
            </li>
            <li><span class="term-highlight">{% translate "Past Perfect Simple:" %}</span> {% translate "Emphasizes the <i>completion</i> of an action before a certain point in the past, or the <i>result</i> of the action." %}
                <ul class="styled-list">
                    <li><i><span class="code-highlight">{% translate "I" %} <span class="verb-highlight">had written</span> {% translate "the report by noon." %}</span></i> ({% translate "Focus on the <i>completion</i> of the report." %})</li>
                    <li><i><span class="code-highlight">{% translate "When he arrived, I" %} <span class="verb-highlight">had finished</span> {% translate "my work." %}</span></i> ({% translate "Focus on the <i>result</i> - my work was done." %})</li>
                </ul>
            </li>
        </ul>
        <ul class="styled-list">
            <li>{% translate "Sometimes, especially with verbs like" %} <span class="code-highlight">live</span>, <span class="code-highlight">work</span>, <span class="code-highlight">study</span>, {% translate "the Past Perfect Simple can be used to talk about duration, and the meaning is very similar:" %}
                <ul class="styled-list">
                    <li><i><span class="code-highlight">{% translate "They" %} <span class="verb-highlight">had lived</span> {% translate "in that city for five years before they moved." %}</span></i></li>
                    <li><i><span class="code-highlight">{% translate "They" %} <span class="verb-highlight">had been living</span> {% translate "in that city for five years before they moved." %}</span></i> ({% translate "Both are correct and mean similar things, with the continuous emphasizing the ongoing nature." %})</li>
                </ul>
            </li>
        </ul>
        <p>
            {% translate "The Past Perfect Continuous helps to provide a more dynamic description of past events, showing how long something was happening before something else occurred." %}
        </p>
        
        <div class="navigation-links">
            <a href="{% url 'verbs_page' %}" class="back-to-list-btn">
                <i class="fas fa-arrow-left"></i> {% translate "Back to Verbs" %}
            </a>
        </div>
    </div>
{% endblock %}